/*
 * Copyright (C) 2007-2011 Diego Perini
 * All rights reserved.
 *
 * nwmatcher.js - A fast CSS selector engine and matcher
 *
 * Author: Diego Perini <diego.perini at gmail com>
 * Version: 1.2.4
 * Created: 20070722
 * Release: 20110601
 *
 * License:
 *  http://javascript.nwbox.com/NWMatcher/MIT-LICENSE
 * Download:
 *  http://javascript.nwbox.com/NWMatcher/nwmatcher.js
 */
(function(a){var b="nwmatcher-1.2.4",c=typeof exports=="object"?exports:(a.NW||(a.NW={}))&&(a.NW.Dom||(a.NW.Dom={})),d=a.document,e=d.documentElement,f=[].slice,g={}.toString,h,i,j,k,l,m,n,o,p,q="[#.:]?",r="([~*^$|!]?={1})",s="[\\x20\\t\\n\\r\\f]*",t="[\\x20]|[>+~][^>+~]",u="[-+]?\\d*n?[-+]?\\d*",v="\"[^\"]*\"|'[^']*'",w="\\([^()]+\\)|\\(.*\\)",x="\\{[^{}]+\\}|\\{.*\\}",y="\\[[^[\\]]*\\]|\\[.*\\]",z="\\[.*\\]|\\(.*\\)|\\{.*\\}",A="(?:[-\\w]|[^\\x00-\\xa0]|\\\\.)",B="(?:-?[_a-zA-Z]{1}[-\\w]*|[^\\x00-\\xa0]+|\\\\.+)+",C="("+v+"|"+B+")",D=s+"("+A+"+:?"+A+"+)"+s+"(?:"+r+s+C+")?"+s,E=D.replace(C,"([\\x22\\x27]*)((?:\\\\?.)*?)\\3"),F="((?:"+u+"|"+v+"|"+q+"|"+A+"+|"+"\\["+D+"\\]|"+"\\(.+\\)|"+s+"|"+",)+)",G=".+",H="(?=[\\x20\\t\\n\\r\\f]*[^>+~(){}<>])(\\*|(?:"+q+B+")"+"|"+t+"|\\["+D+"\\]"+"|\\("+F+"\\)"+"|\\{"+G+"\\}"+"|,"+")+",I=H.replace(F,".*"),J=new RegExp(H,"g"),K=new RegExp("^"+s+"|"+s+"$","g"),L=new RegExp("^((?!:not)("+q+"|"+B+"|\\([^()]*\\))+"+"|\\["+D+"\\]"+")$"),M=new RegExp("([^,\\\\\\[\\]]+|"+y+"|"+w+"|"+x+"|\\\\."+")+","g"),N=new RegExp("(\\["+D+"\\]|"+"\\("+F+"\\)|"+"[^\\x20>+~]|\\\\.)+","g"),O=/[\x20\t\n\r\f]+/g,P=new RegExp(B+"|^$"),Q=function(){var a=(d.appendChild+"").replace(/appendChild/g,"");return function(b,c){var d=b&&b[c]||!1;return d&&typeof d!="string"&&a==(d+"").replace(new RegExp(c,"g"),"")}}(),R=Q(d,"hasFocus"),S=Q(d,"querySelector"),T=Q(d,"getElementById"),U=Q(e,"getElementsByTagName"),V=Q(e,"getElementsByClassName"),W=Q(e,"getAttribute"),X=Q(e,"hasAttribute"),Y=function(){var a=!1,b=e.id;e.id="length";try{a=!!f.call(d.childNodes,0)[0]}catch(c){}return e.id=b,a}(),Z="nextElementSibling"in e&&"previousElementSibling"in e,$=Q(e,"matchesSelector")?"matchesSelector":Q(e,"oMatchesSelector")?"oMatchesSelector":Q(e,"msMatchesSelector")?"msMatchesSelector":Q(e,"mozMatchesSelector")?"mozMatchesSelector":Q(e,"webkitMatchesSelector")?"webkitMatchesSelector":null,_=T?function(){var a=!0,b="x"+String(+(new Date)),c=d.createElementNS?"a":'<a name="'+b+'">';return(c=d.createElement(c)).name=b,e.insertBefore(c,e.firstChild),a=!!d.getElementById(b),e.removeChild(c),a}():!0,ab=U?function(){var a=d.createElement("div");return a.appendChild(d.createComment("")),!!a.getElementsByTagName("*")[0]}():!0,bb=V?function(){var a,b=d.createElement("div"),c="台北";return b.appendChild(d.createElement("span")).setAttribute("class",c+"abc "+c),b.appendChild(d.createElement("span")).setAttribute("class","x"),a=!b.getElementsByClassName(c)[0],b.lastChild.className=c,a||b.getElementsByClassName(c).length!=2}():!0,cb=W?function(){var a=d.createElement("input");return a.setAttribute("value",5),a.defaultValue!=5}():!0,db=X?function(){var a=d.createElement("option");return a.setAttribute("selected","selected"),!a.hasAttribute("selected")}():!0,eb=$?function(){try{return e[$](":buggy"),!0}catch(a){}return!1}():!0,fb=function(){var a=d.createElement("select");return a.appendChild(d.createElement("option")),!a.firstChild.selected}(),gb,hb,ib,jb,kb,lb=/opera/i.test(g.call(a.opera)),mb=lb&&parseFloat(opera.version())>=11,nb=S?function(){var a=[],b=d.createElement("div"),c,e=function(a,b,c,d){var e=!1;b.appendChild(c);try{e=b.querySelectorAll(a).length==d}catch(f){}while(b.firstChild)b.removeChild(b.firstChild);return e};return c=d.createElement("p"),c.setAttribute("class",""),e('[class^=""]',b,c,1)&&a.push("[*^$]=[\\x20\\t\\n\\r\\f]*(?:\"\"|'')"),c=d.createElement("option"),c.setAttribute("selected","selected"),e(":checked",b,c,0)&&a.push(":checked"),c=d.createElement("input"),c.setAttribute("type","hidden"),e(":enabled",b,c,1)&&a.push(":enabled",":disabled"),c=d.createElement("link"),c.setAttribute("href","x"),e(":link",b,c,1)||a.push(":link"),db&&a.push("\\[[\\x20\\t\\n\\r\\f]*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),a.length?new RegExp(a.join("|")):{test:function(){return!1}}}():!0,ob=new RegExp("(?:\\[[\\x20\\t\\n\\r\\f]*class\\b|\\."+B+")"),pb=new RegExp(":[-\\w]+"),qb=new RegExp(!ab||!bb?lb?"^(?:\\*|#-?[_a-zA-Z]{1}"+A+"*)$":"^(?:\\*|[.#]?-?[_a-zA-Z]{1}"+A+"*)$":"^#?-?[_a-zA-Z]{1}"+A+"*$"),rb={a:1,A:1,area:1,AREA:1,link:1,LINK:1},sb={checked:1,disabled:1,ismap:1,multiple:1,readonly:1,selected:1},tb={value:"defaultValue",checked:"defaultChecked",selected:"defaultSelected"},ub={"class":"className","for":"htmlFor"},vb={action:2,cite:2,codebase:2,data:2,href:2,longdesc:2,lowsrc:2,src:2,usemap:2},wb={"class":0,accept:1,"accept-charset":1,align:1,alink:1,axis:1,bgcolor:1,charset:1,checked:1,clear:1,codetype:1,color:1,compact:1,declare:1,defer:1,dir:1,direction:1,disabled:1,enctype:1,face:1,frame:1,hreflang:1,"http-equiv":1,lang:1,language:1,link:1,media:1,method:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,rel:1,rev:1,rules:1,scope:1,scrolling:1,selected:1,shape:1,target:1,text:1,type:1,valign:1,valuetype:1,vlink:1},xb={accept:1,"accept-charset":1,alink:1,axis:1,bgcolor:1,charset:1,codetype:1,color:1,enctype:1,face:1,hreflang:1,"http-equiv":1,lang:1,language:1,link:1,media:1,rel:1,rev:1,target:1,text:1,type:1,vlink:1},yb={},zb={"=":"n=='%m'","^=":"n.indexOf('%m')==0","*=":"n.indexOf('%m')>-1","|=":"(n+'-').indexOf('%m-')==0","~=":"(' '+n+' ').indexOf(' %m ')>-1","$=":"n.substr(n.length-'%m'.length)=='%m'"},Ab={ID:new RegExp("^\\*?#("+A+"+)|"+z),TAG:new RegExp("^("+A+"+)|"+z),CLASS:new RegExp("^\\*?\\.("+A+"+$)|"+z)},Bb={spseudos:/^\:((root|empty|nth-)?(?:(first|last|only)-)?(child)?-?(of-type)?)(?:\(([^\x29]*)\))?(.*)/,dpseudos:/^\:(link|visited|target|lang|not|active|focus|hover|checked|disabled|enabled|selected)(?:\((["']*)(.*?(\(.*\))?[^'"()]*?)\2\))?(.*)/,attribute:new RegExp("^\\["+E+"\\](.*)"),children:/^[\x20\t\n\r\f]*\>[\x20\t\n\r\f]*(.*)/,adjacent:/^[\x20\t\n\r\f]*\+[\x20\t\n\r\f]*(.*)/,relative:/^[\x20\t\n\r\f]*\~[\x20\t\n\r\f]*(.*)/,ancestor:/^[\x20\t\n\r\f]+(.*)/,universal:/^\*(.*)/,id:new RegExp("^#("+A+"+)(.*)"),tagName:new RegExp("^("+A+"+)(.*)"),className:new RegExp("^\\.("+A+"+)(.*)")},Cb=function(a,b){var c=-1,d;if(!a.length&&Array.slice)return Array.slice(b);while(d=b[++c])a[a.length]=d;return a},Db=function(a,b,c){var d=-1,e;while(e=b[++d])c(a[a.length]=e);return a},Eb=function(a,b){var f,g=d;k=a,d=a.ownerDocument||a;if(b||g!==d)e=d.documentElement,kb=d.createElement("DiV").nodeName=="DiV",jb=kb?".toUpperCase()":"",ib=!kb&&typeof d.compatMode=="string"?d.compatMode.indexOf("CSS")<0:function(){var a=d.createElement("div").style;return a&&(a.width=1)&&a.width=="1px"}(),f=d.createElement("div"),f.appendChild(d.createElement("p")).setAttribute("class","xXx"),f.appendChild(d.createElement("p")).setAttribute("class","xxx"),gb=!kb&&V&&ib&&(f.getElementsByClassName("xxx").length!=2||f.getElementsByClassName("xXx").length!=2),hb=!kb&&S&&ib&&(f.querySelectorAll("[class~=xxx]").length!=2||f.querySelectorAll(".xXx").length!=2),Yb.CACHING&&c.setCache(!0,d)},Fb=function(a,b){var c=-1,d=null;while(d=b[++c])if(d.getAttribute("id")==a)break;return d},Gb=_?function(a,b){var c=null;return a=a.replace(/\\/g,""),kb||b.nodeType!=9?Fb(a,b.getElementsByTagName("*")):(c=b.getElementById(a))&&c.name==a&&b.getElementsByName?Fb(a,b.getElementsByName(a)):c}:function(a,b){return a=a.replace(/\\/g,""),b.getElementById&&b.getElementById(a)||Fb(a,b.getElementsByTagName("*"))},Hb=function(a,b){return Eb(b||(b=d)),Gb(a,b)},Ib=function(a,b){var c=a=="*",d=b,e=[],f=d.firstChild;c||(a=a.toUpperCase());while(d=f){d.tagName>"@"&&(c||d.tagName.toUpperCase()==a)&&(e[e.length]=d);if(f=d.firstChild||d.nextSibling)continue;while(!f&&(d=d.parentNode)&&d!==b)f=d.nextSibling}return e},Jb=!ab&&Y?function(a,b){return kb||b.nodeType==11?Ib(a,b):f.call(b.getElementsByTagName(a),0)}:function(a,b){var c=-1,d=c,e=[],f,g=b.getElementsByTagName(a);if(a=="*")while(f=g[++c])f.nodeName>"@"&&(e[++d]=f);else while(f=g[++c])e[c]=f;return e},Kb=function(a,b){return Eb(b||(b=d)),Jb(a,b)},Lb=function(a,b){return bc('[name="'+a.replace(/\\/g,"")+'"]',b)},Mb=function(a,b){var c=-1,d=c,e=[],f,g=Jb("*",b),h;a=" "+(ib?a.toLowerCase():a).replace(/\\/g,"")+" ";while(f=g[++c])h=kb?f.getAttribute("class"):f.className,h&&h.length&&(" "+(ib?h.toLowerCase():h).replace(O," ")+" ").indexOf(a)>-1&&(e[++d]=f);return e},Nb=function(a,b){return bb||gb||kb||!b.getElementsByClassName?Mb(a,b):f.call(b.getElementsByClassName(a.replace(/\\/g,"")),0)},Ob=function(a,b){return Eb(b||(b=d)),Nb(a,b)},Pb="compareDocumentPosition"in e?function(a,b){return(a.compareDocumentPosition(b)&16)==16}:"contains"in e?function(a,b){return a!==b&&a.contains(b)}:function(a,b){while(b=b.parentNode)if(b===a)return!0;return!1},Qb=cb?function(a,b){return b=b.toLowerCase(),b=ub[b]||b,tb[b]?a[tb[b]]||"":vb[b]?a.getAttribute(b,2)||"":sb[b]?a.getAttribute(b)?b:"":(a=a.getAttributeNode(b))&&a.value||""}:function(a,b){return a.getAttribute(b)||""},Rb=db?function(a,b){return b=b.toLowerCase(),b=ub[b]||b,tb[b]?!!a[tb[b]]:(a=a.getAttributeNode(b),!(!a||!a.specified&&!a.nodeValue))}:function(a,b){return kb?!!a.getAttribute(b):a.hasAttribute(b)},Sb=function(a){a=a.firstChild;while(a){if(a.nodeType==3||a.nodeName>"@")return!1;a=a.nextSibling}return!0},Tb=function(a){return Rb(a,"href")&&rb[a.nodeName]},Ub=function(a,b){var c=1,d=b?"nextSibling":"previousSibling";while(a=a[d])a.nodeName>"@"&&++c;return c},Vb=function(a,b){var c=1,d=b?"nextSibling":"previousSibling",e=a.nodeName;while(a=a[d])a.nodeName==e&&++c;return c},Wb=function(a){for(var b in a)Yb[b]=!!a[b],b=="SIMPLENOT"?(cc={},dc={},ec={},fc={},Yb.USE_QSAPI=!1,J=new RegExp(I,"g")):b=="USE_QSAPI"&&(Yb[b]=!!a[b]&&S,J=new RegExp(H,"g"))},Xb=function(b){if(Yb.VERBOSITY){if(typeof a.DOMException!="undefined"){var c=new Error;throw c.message="SYNTAX_ERR: (Selectors) "+b,c.code=12,c}throw new Error(12,"SYNTAX_ERR: (Selectors) "+b)}var d=a.console;d&&d.log?d.log(b):/exception/i.test(b)?(a.status=b,a.defaultStatus=b):a.status+=b},Yb={CACHING:!1,SHORTCUTS:!1,SIMPLENOT:!0,USE_HTML5:!1,USE_QSAPI:S,VERBOSITY:!0},Zb="f&&f(c[k]);r[r.length]=c[k];continue main;",$b=function(a,b,c){var d=typeof a=="string"?a.match(M):a;if(d.length==1)b+=_b(d[0],c?Zb:"f&&f(k);return true;");else{var e=-1,f={},g;while(g=d[++e])g=g.replace(K,""),!f[g]&&(f[g]=!0)&&(b+=_b(g,c?Zb:"f&&f(k);return true;"))}return c?new Function("c,s,r,d,h,g,f","var N,n,x=0,k=-1,e;main:while((e=c[++k])){"+b+"}return r;"):new Function("e,s,r,d,h,g,f","var N,n,x=0,k=e;"+b+"return false;")},_b=function(a,b){var c,e,f,g=0,h,i,j,k,l,m;while(a){g++;if(i=a.match(Bb.universal))h="";else if(i=a.match(Bb.id))b="if("+(kb?'s.getAttribute(e,"id")':'(e.submit?s.getAttribute(e,"id"):e.id)')+'=="'+i[1]+'"'+"){"+b+"}";else if(i=a.match(Bb.tagName))b="if(e.nodeName"+(kb?'=="'+i[1]+'"':jb+'=="'+i[1].toUpperCase()+'"')+"){"+b+"}";else if(i=a.match(Bb.className))b="if((n="+(kb?'s.getAttribute(e,"class")':"e.className")+')&&n.length&&(" "+'+(ib?"n.toLowerCase()":"n")+".replace("+O+'," ")+" ").indexOf(" '+(ib?i[1].toLowerCase():i[1])+' ")>-1'+"){"+b+"}";else if(i=a.match(Bb.attribute)){h=i[1].split(":"),h=h.length==2?h[1]:h[0]+"";if(i[2]&&!zb[i[2]])return Xb('Unsupported operator in attribute selectors "'+a+'"'),"";l=!1,m="false";if(i[2]&&i[4]&&(m=zb[i[2]]))wb["class"]=ib?1:0,i[4]=i[4].replace(/\\([0-9a-f]{2,2})/,"\\x$1"),l=(kb?xb:wb)[h.toLowerCase()],m=m.replace(/\%m/g,l?i[4].toLowerCase():i[4]);else if(i[2]=="!="||i[2]=="=")m="n"+i[2]+'="'+i[4]+'"';h="n=s."+(i[2]?"get":"has")+'Attribute(e,"'+i[1]+'")'+(l?".toLowerCase();":";"),b=h+"if("+(i[2]?m:"n")+"){"+b+"}"}else if(i=a.match(Bb.adjacent))b=Z?"var N"+g+"=e;if(e&&(e=e.previousElementSibling)){"+b+"}e=N"+g+";":"var N"+g+'=e;while(e&&(e=e.previousSibling)){if(e.nodeName>"@"){'+b+"break;}}e=N"+g+";";else if(i=a.match(Bb.relative))b=Z?"var N"+g+"=e;e=e.parentNode.firstElementChild;"+"while(e&&e!==N"+g+"){"+b+"e=e.nextElementSibling;}e=N"+g+";":"var N"+g+"=e;e=e.parentNode.firstChild;"+"while(e&&e!==N"+g+'){if(e.nodeName>"@"){'+b+"}e=e.nextSibling;}e=N"+g+";";else if(i=a.match(Bb.children))b="var N"+g+"=e;if(e&&e!==h&&e!==g&&(e=e.parentNode)){"+b+"}e=N"+g+";";else if(i=a.match(Bb.ancestor))b="var N"+g+"=e;while(e&&e!==h&&e!==g&&(e=e.parentNode)){"+b+"}e=N"+g+";";else if((i=a.match(Bb.spseudos))&&i[1])switch(i[2]){case"root":i[7]?b="if(e===h||s.contains(h,e)){"+b+"}":b="if(e===h){"+b+"}";break;case"empty":b="if(s.isEmpty(e)){"+b+"}";break;default:if(i[2]&&i[6]){if(i[6]=="n"){b="if(e!==h){"+b+"}";break}i[6]=="even"?(c=2,e=0):i[6]=="odd"?(c=2,e=1):(e=(f=i[6].match(/(-?\d+)$/))?parseInt(f[1],10):0,c=(f=i[6].match(/(-?\d*)n/))?parseInt(f[1],10):0,f&&f[1]=="-"&&(c=-1)),l=e<1&&c>1?"(n-("+e+"))%"+c+"==0":c>1?i[3]=="last"?"(n-("+e+"))%"+c+"==0":"n>="+e+"&&(n-("+e+"))%"+c+"==0":c<-1?i[3]=="last"?"(n-("+e+"))%"+c+"==0":"n<="+e+"&&(n-("+e+"))%"+c+"==0":c===0?"n=="+e:i[3]=="last"?c==-1?"n>="+e:"n<="+e:c==-1?"n<="+e:"n>="+e,b="if(e!==h){n=s["+(i[5]?'"nthOfType"':'"nthElement"')+"]"+"(e,"+(i[3]=="last"?"true":"false")+");"+"if("+l+"){"+b+"}"+"}"}else c=i[3]=="first"?"previous":"next",f=i[3]=="only"?"previous":"next",e=i[3]=="first"||i[3]=="last",m=i[5]?"&&n.nodeName!=e.nodeName":'&&n.nodeName<"@"',b="if(e!==h){"+("n=e;while((n=n."+c+"Sibling)"+m+");if(!n){"+(e?b:"n=e;while((n=n."+f+"Sibling)"+m+");if(!n){"+b+"}")+"}")+"}"}else if((i=a.match(Bb.dpseudos))&&i[1])switch(i[1]){case"not":h=i[3].replace(K,"");if(Yb.SIMPLENOT&&!L.test(h))return Xb('Negation pseudo-class only accepts simple selectors "'+a+'"'),"";"compatMode"in d?b="if(!"+$b([h],"",!1)+"(e,s,r,d,h,g)){"+b+"}":b='if(!s.match(e, "'+h.replace(/\x22/g,'\\"')+'",g)){'+b+"}";break;case"checked":l='if((typeof e.form!="undefined"&&(/^(?:radio|checkbox)$/i).test(e.type)&&e.checked)',b=(Yb.USE_HTML5?l+"||(/^option$/i.test(e.nodeName)&&e.selected)":l)+"){"+b+"}";break;case"disabled":b='if(((typeof e.form!="undefined"&&!(/^hidden$/i).test(e.type))||s.isLink(e))&&e.disabled){'+b+"}";break;case"enabled":b='if(((typeof e.form!="undefined"&&!(/^hidden$/i).test(e.type))||s.isLink(e))&&!e.disabled){'+b+"}";break;case"lang":l="",i[3]&&(l=i[3].substr(0,2)+"-"),b='do{(n=e.lang||"").toLowerCase();if((n==""&&h.lang=="'+i[3].toLowerCase()+'")||'+'(n&&(n=="'+i[3].toLowerCase()+'"||n.substr(0,3)=="'+l.toLowerCase()+'")))'+"{"+b+"break;}}while((e=e.parentNode)&&e!==g);";break;case"target":f=d.location?d.location.hash:"",f&&(b='if(e.id=="'+f.slice(1)+'"){'+b+"}");break;case"link":b="if(s.isLink(e)&&!e.visited){"+b+"}";break;case"visited":b="if(s.isLink(e)&&e.visited){"+b+"}";break;case"active":if(kb)break;b="if(e===d.activeElement){"+b+"}";break;case"hover":if(kb)break;b="if(e===d.hoverElement){"+b+"}";break;case"focus":if(kb)break;b=R?"if(e===d.activeElement&&d.hasFocus()&&(e.type||e.href)){"+b+"}":"if(e===d.activeElement&&(e.type||e.href)){"+b+"}";break;case"selected":h=fb?"||(n=e.parentNode)&&n.options[n.selectedIndex]===e":"",b="if(/^option$/i.test(e.nodeName)&&(e.selected"+h+")){"+b+"}";break;default:}else{h=!1,k=!0;for(h in yb)if((i=a.match(yb[h].Expression))&&i[1]){j=yb[h].Callback(i,b),b=j.source,k=j.status;if(k)break}if(!k)return Xb('Unknown pseudo-class selector "'+a+'"'),"";if(!h)return Xb('Unknown token in selector "'+a+'"'),""}if(!i)return Xb('Invalid syntax in selector "'+a+'"'),"";a=i&&i[i.length-1]}return b},ac=function(a,b,c,f){var g;if(!(a&&a.nodeName>"@"))return Xb("Invalid element argument"),!1;if(!b||typeof b!="string")return Xb("Invalid selector argument"),!1;if(c&&c.nodeType==1&&!Pb(c,a))return!1;k!==c&&Eb(c||(c=a.ownerDocument)),b=b.replace(K,""),Yb.SHORTCUTS&&(b=NW.Dom.shortcuts(b,a,c));if(m!=b){if(!(g=b.match(J))||g[0]!=b)return Xb('The string "'+b+'", is not a valid CSS selector'),!1;h=(g=b.match(M)).length<2,m=b,o=g}else g=o;if(!kb&&Yb.USE_QSAPI&&a[$]&&(!hb||!ob.test(b))&&(!eb||!pb.test(b))&&!nb.test(b))try{return a[$](b)?(typeof f=="function"&&f(a),!0):!1}catch(i){}if(!dc[b]||cc[b]!==c)dc[b]=$b(h?[b]:g,"",!1),cc[b]=c;return dc[b](a,gc,[],d,e,c,f)},bc=function(a,b,g){var h,m,o,q,r,s,t=a;if(arguments.length===0)return Xb("Missing required selector parameters"),[];if(a==="")return Xb("Empty selector string"),[];if(typeof a!="string")return[];k!==b&&Eb(b||(b=d));if(Yb.CACHING&&(q=c.loadResults(t,b,d,e)))return g?Db([],q,g):q;if(!mb&&qb.test(a))switch(a.charAt(0)){case"#":(o=Gb(a.slice(1),b))?q=[o]:q=[];break;case".":q=Nb(a.slice(1),b);break;default:q=Jb(a,b)}else if(!kb&&Yb.USE_QSAPI&&(!hb||!ob.test(a))&&!nb.test(a))try{q=b.querySelectorAll(a)}catch(u){}if(q)return q=g?Db([],q,g):Y?f.call(q):Cb([],q),Yb.CACHING&&c.saveResults(t,b,d,q),q;a=a.replace(K,""),Yb.SHORTCUTS&&(a=NW.Dom.shortcuts(a,b));if(m=n!=a){if(!(r=a.match(J))||r[0]!=a)return Xb('The string "'+a+'", is not a valid CSS selector'),[];i=(r=a.match(M)).length<2,n=a,p=r}else r=p;if(b.nodeType==11)q=b.childNodes;else if(!kb&&i){m&&(r=a.match(N),s=r[r.length-1],j=s.split(":not")[0],l=a.length-s.length);if((r=j.match(Ab.ID))&&(s=r[1])){if(o=Gb(s,b))ac(o,a)?(g&&g(o),q=[o]):q=[]}else(r=a.match(Ab.ID))&&(s=r[1])&&((o=Gb(s,d))?("#"+s==a&&(g&&g(o),q=[o]),/[>+~]/.test(a)?b=o.parentNode:(a=a.replace("#"+s,"*"),l-=s.length+1,b=o)):q=[]);if(q)return Yb.CACHING&&c.saveResults(t,b,d,q),q;if(!V&&(r=j.match(Ab.TAG))&&(s=r[1])){if((q=Jb(s,b)).length===0)return[];a=a.slice(0,l)+a.slice(l).replace(s,"*")}else if((r=j.match(Ab.CLASS))&&(s=r[1])){if((q=Nb(s,b)).length===0)return[];P.test(a.charAt(a.indexOf(s)-1))?a=a.slice(0,l)+a.slice(l).replace("."+s,""):a=a.slice(0,l)+a.slice(l).replace("."+s,"*")}else if((r=a.match(Ab.CLASS))&&(s=r[1])){if((q=Nb(s,b)).length===0)return[];for(var v=0,w=[];q.length>v;++v)w=Cb(w,q[v].getElementsByTagName("*"));q=w,P.test(a.charAt(a.indexOf(s)-1))?a=a.slice(0,l)+a.slice(l).replace("."+s,""):a=a.slice(0,l)+a.slice(l).replace("."+s,"*")}else if(V&&(r=j.match(Ab.TAG))&&(s=r[1])){if((q=Jb(s,b)).length===0)return[];a=a.slice(0,l)+a.slice(l).replace(s,"*")}}q||(q=/^(?:applet|object)$/i.test(b.nodeName)?b.childNodes:Jb("*",b));if(!fc[a]||ec[a]!==b)fc[a]=$b(i?[a]:r,"",!0),ec[a]=b;return q=fc[a](q,gc,[],d,e,b,g),Yb.CACHING&&c.saveResults(t,b,d,q),q},cc={},dc={},ec={},fc={},gc={nthElement:Ub,nthOfType:Vb,getAttribute:Qb,hasAttribute:Rb,byClass:Nb,byName:Lb,byTag:Jb,byId:Gb,contains:Pb,isEmpty:Sb,isLink:Tb,select:bc,match:ac};Tokens={prefixes:q,encoding:A,operators:r,whitespace:s,identifier:B,attributes:D,combinators:t,pseudoclass:F,pseudoparms:u,quotedvalue:v},c.emit=Xb,c.byId=Hb,c.byTag=Kb,c.byName=Lb,c.byClass=Ob,c.getAttribute=Qb,c.hasAttribute=Rb,c.match=ac,c.select=bc,c.compile=$b,c.contains=Pb,c.configure=Wb,c.setCache=function(){return},c.loadResults=function(){return},c.saveResults=function(){return},c.shortcuts=function(a){return a},c.Config=Yb,c.Snapshot=gc,c.Operators=zb,c.Selectors=yb,c.Tokens=Tokens,c.registerOperator=function(a,b){zb[a]||(zb[a]=b)},c.registerSelector=function(a,b,c){yb[a]||(yb[a]={Expression:b,Callback:c})},Eb(d,!0)})(this);